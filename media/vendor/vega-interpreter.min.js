var vegaInterpreter=(()=>{var p=Object.defineProperty;var D=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var E=Object.prototype.hasOwnProperty;var N=(t,n)=>{for(var e in n)p(t,e,{get:n[e],enumerable:!0})},y=(t,n,e,r)=>{if(n&&typeof n=="object"||typeof n=="function")for(let o of x(n))!E.call(t,o)&&o!==e&&p(t,o,{get:()=>n[o],enumerable:!(r=D(n,o))||r.enumerable});return t};var S=t=>y(p({},"__esModule",{value:!0}),t);var V={};N(V,{expressionInterpreter:()=>G});function f(t,n,e){return t.fields=n||[],t.fname=e,t}function L(t){return t.length===1?O(t[0]):j(t)}var O=t=>function(n){return n[t]},j=t=>{let n=t.length;return function(e){for(let r=0;r<n;++r)e=e[t[r]];return e}};function d(t){throw Error(t)}function A(t){let n=[],e=t.length,r=null,o=0,i="",s,u,c;t=t+"";function a(){n.push(i+t.substring(s,u)),i="",s=u+1}for(s=u=0;u<e;++u)if(c=t[u],c==="\\")i+=t.substring(s,u++),s=u;else if(c===r)a(),r=null,o=-1;else{if(r)continue;s===o&&c==='"'||s===o&&c==="'"?(s=u+1,r=c):c==="."&&!o?u>s?a():s=u+1:c==="["?(u>s&&a(),o=s=u+1):c==="]"&&(o||d("Access path missing open bracket: "+t),o>0&&a(),o=0,s=u+1)}return o&&d("Access path missing closing bracket: "+t),r&&d("Access path missing closing quote: "+t),u>s&&(u++,a()),n}function U(t,n,e){let r=A(t);return t=r.length===1?r[0]:t,f((e&&e.get||L)(r),[t],n||t)}var Q=U("id"),H=f(t=>t,[],"identity"),W=f(()=>0,[],"zero"),X=f(()=>1,[],"one"),Y=f(()=>!0,[],"true"),J=f(()=>!1,[],"false");var K=Array.isArray;var b=(t,n)=>(t<n||t==null)&&n!=null?-1:(t>n||n==null)&&t!=null?1:(n=n instanceof Date?+n:n,(t=t instanceof Date?+t:t)!==t&&n===n?-1:n!==n&&t===t?1:0);function w(t){return typeof t=="string"}function C(t,n,e){let r;n.x2&&(n.x?(e&&t.x>t.x2&&(r=t.x,t.x=t.x2,t.x2=r),t.width=t.x2-t.x):t.x=t.x2-(t.width||0)),n.xc&&(t.x=t.xc-(t.width||0)/2),n.y2&&(n.y?(e&&t.y>t.y2&&(r=t.y,t.y=t.y2,t.y2=r),t.height=t.y2-t.y):t.y=t.y2-(t.height||0)),n.yc&&(t.y=t.yc-(t.height||0)/2)}var I={NaN:NaN,E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG2E:Math.LOG2E,LOG10E:Math.LOG10E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,MIN_VALUE:Number.MIN_VALUE,MAX_VALUE:Number.MAX_VALUE},T={"*":(t,n)=>t*n,"+":(t,n)=>t+n,"-":(t,n)=>t-n,"/":(t,n)=>t/n,"%":(t,n)=>t%n,">":(t,n)=>t>n,"<":(t,n)=>t<n,"<=":(t,n)=>t<=n,">=":(t,n)=>t>=n,"==":(t,n)=>t==n,"!=":(t,n)=>t!=n,"===":(t,n)=>t===n,"!==":(t,n)=>t!==n,"&":(t,n)=>t&n,"|":(t,n)=>t|n,"^":(t,n)=>t^n,"<<":(t,n)=>t<<n,">>":(t,n)=>t>>n,">>>":(t,n)=>t>>>n},z={"+":t=>+t,"-":t=>-t,"~":t=>~t,"!":t=>!t},F=Array.prototype.slice,l=(t,n,e)=>{let r=e?e(n[0]):n[0];return r[t].apply(r,F.call(n,1))},R=function(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,i=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:0;return w(t)?new Date(t):new Date(t,n,e,r,o,i,s)},P={isNaN:Number.isNaN,isFinite:Number.isFinite,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:Math.atan2,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,random:Math.random,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,clamp:(t,n,e)=>Math.max(n,Math.min(e,t)),now:Date.now,utc:Date.UTC,datetime:R,date:t=>new Date(t).getDate(),day:t=>new Date(t).getDay(),year:t=>new Date(t).getFullYear(),month:t=>new Date(t).getMonth(),hours:t=>new Date(t).getHours(),minutes:t=>new Date(t).getMinutes(),seconds:t=>new Date(t).getSeconds(),milliseconds:t=>new Date(t).getMilliseconds(),time:t=>new Date(t).getTime(),timezoneoffset:t=>new Date(t).getTimezoneOffset(),utcdate:t=>new Date(t).getUTCDate(),utcday:t=>new Date(t).getUTCDay(),utcyear:t=>new Date(t).getUTCFullYear(),utcmonth:t=>new Date(t).getUTCMonth(),utchours:t=>new Date(t).getUTCHours(),utcminutes:t=>new Date(t).getUTCMinutes(),utcseconds:t=>new Date(t).getUTCSeconds(),utcmilliseconds:t=>new Date(t).getUTCMilliseconds(),length:t=>t.length,join:function(){return l("join",arguments)},indexof:function(){return l("indexOf",arguments)},lastindexof:function(){return l("lastIndexOf",arguments)},slice:function(){return l("slice",arguments)},reverse:t=>t.slice().reverse(),sort:t=>t.slice().sort(b),parseFloat,parseInt,upper:t=>String(t).toUpperCase(),lower:t=>String(t).toLowerCase(),substring:function(){return l("substring",arguments,String)},split:function(){return l("split",arguments,String)},replace:function(){return l("replace",arguments,String)},trim:t=>String(t).trim(),btoa:t=>btoa(t),atob:t=>atob(t),regexp:RegExp,test:(t,n)=>RegExp(t).test(n)},v=["view","item","group","xy","x","y"],M=new Set([Function,eval,setTimeout,setInterval]);typeof setImmediate=="function"&&M.add(setImmediate);var q={Literal:(t,n)=>n.value,Identifier:(t,n)=>{let e=n.name;return t.memberDepth>0?e:e==="datum"?t.datum:e==="event"?t.event:e==="item"?t.item:I[e]||t.params["$"+e]},MemberExpression:(t,n)=>{let e=!n.computed,r=t(n.object);e&&(t.memberDepth+=1);let o=t(n.property);if(e&&(t.memberDepth-=1),M.has(r[o])){console.error(`Prevented interpretation of member "${o}" which could lead to insecure code execution`);return}return r[o]},CallExpression:(t,n)=>{let e=n.arguments,r=n.callee.name;return r.startsWith("_")&&(r=r.slice(1)),r==="if"?t(e[0])?t(e[1]):t(e[2]):(t.fn[r]||P[r]).apply(t.fn,e.map(t))},ArrayExpression:(t,n)=>n.elements.map(t),BinaryExpression:(t,n)=>T[n.operator](t(n.left),t(n.right)),UnaryExpression:(t,n)=>z[n.operator](t(n.argument)),ConditionalExpression:(t,n)=>t(n.test)?t(n.consequent):t(n.alternate),LogicalExpression:(t,n)=>n.operator==="&&"?t(n.left)&&t(n.right):t(n.left)||t(n.right),ObjectExpression:(t,n)=>n.properties.reduce((e,r)=>{t.memberDepth+=1;let o=t(r.key);return t.memberDepth-=1,M.has(t(r.value))?console.error(`Prevented interpretation of property "${o}" which could lead to insecure code execution`):e[o]=t(r.value),e},{})};function g(t,n,e,r,o,i){let s=u=>q[u.type](s,u);return s.memberDepth=0,s.fn=Object.create(n),s.params=e,s.datum=r,s.event=o,s.item=i,v.forEach(u=>s.fn[u]=function(){return o.vega[u](...arguments)}),s(t)}var G={operator(t,n){let e=n.ast,r=t.functions;return o=>g(e,r,o)},parameter(t,n){let e=n.ast,r=t.functions;return(o,i)=>g(e,r,i,o)},event(t,n){let e=n.ast,r=t.functions;return o=>g(e,r,void 0,void 0,o)},handler(t,n){let e=n.ast,r=t.functions;return(o,i)=>{let s=i.item&&i.item.datum;return g(e,r,o,s,i)}},encode(t,n){let{marktype:e,channels:r}=n,o=t.functions,i=e==="group"||e==="image"||e==="rect";return(s,u)=>{let c=s.datum,a=0,h;for(let m in r)h=g(r[m].ast,o,u,c,void 0,s),s[m]!==h&&(s[m]=h,a=1);return e!=="rule"&&C(s,r,i),a}}};return S(V);})();
